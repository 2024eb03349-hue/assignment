#!/bin/bash

INPUT_FILE="emails.txt"
VALID_FILE="valid.txt"
INVALID_FILE="invalid.txt"
TEMP_FILE="temp_valid.txt"

# Check if input file exists
if [ ! -f "$INPUT_FILE" ]; then
    echo "Error: $INPUT_FILE not found."
    exit 1
fi

# Clear output files
> "$VALID_FILE"
> "$INVALID_FILE"
> "$TEMP_FILE"

# Process each email
while read -r email; do
    # Remove leading/trailing whitespace
    email=$(echo "$email" | xargs)
    
    # Skip empty lines
    [ -z "$email" ] && continue
    
    # Check email pattern: letters_and_digits@letters.com
    if echo "$email" | grep -q '^[[:alnum:]]\+@[[:alpha:]]\+\.com$'; then
        echo "$email" >> "$TEMP_FILE"
    else
        echo "$email" >> "$INVALID_FILE"
    fi
done < "$INPUT_FILE"

# Remove duplicates from valid emails and sort
sort "$TEMP_FILE" | uniq > "$VALID_FILE"

# Clean up temp file
rm -f "$TEMP_FILE"

echo "Email cleaning completed:"
echo "Valid emails saved to: $VALID_FILE"
echo "Invalid emails saved to: $INVALID_FILE"
